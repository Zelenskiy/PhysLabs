<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ7 - –î–∏—Ñ—Ä–∞–∫—Ü—ñ—è —Å–≤—ñ—Ç–ª–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .student {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .student h2 {
            color: #667eea;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .txt_inp {
            width: 100%;
            padding: 12px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .txt_inp:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .simulation-container {
            background: #000;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        canvas {
            width: 100%;
            border-radius: 8px;
            display: block;
            background: #000;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        .control-group label {
            color: #667eea;
            font-weight: 600;
            font-size: 14px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            width: 200px;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .value-display {
            min-width: 80px;
            text-align: center;
            font-weight: bold;
            color: #764ba2;
        }

        button {
            padding: 10px 20px;
            font-size: 13px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .info-box {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .formula {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            text-align: center;
            margin: 15px 0;
            font-size: 1.2em;
            border: 2px solid #ffc107;
        }

        .experiment-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .experiment-table th {
            background: #764ba2;
            color: white;
            padding: 12px;
            text-align: center;
            font-size: 13px;
        }

        .experiment-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .experiment-table input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
            resize: vertical;
        }

        .submit_block {
            text-align: center;
            margin: 40px 0;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
        }

        .submit_block button {
            background: white;
            color: #667eea;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .measurement-display {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .instruction-list {
            background: white;
            padding: 15px 15px 15px 35px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .instruction-list li {
            margin: 10px 0;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåà –õ–ê–ë–û–†–ê–¢–û–†–ù–ê –†–û–ë–û–¢–ê ‚Ññ 7</h1>
            <p>–í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ —Å–≤—ñ—Ç–ª–æ–≤–æ—ó —Ö–≤–∏–ª—ñ</p>
        </div>

        <div class="content">
            <input type="text" id="sheetName" hidden value="–í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ —Å–≤—ñ—Ç–ª–æ–≤–æ—ó —Ö–≤–∏–ª—ñ">

            <div class="student">
                <h2>–í–ø–∏—à—ñ—Ç—å –≤–∞—à –∫–ª–∞—Å</h2>
                <div><input class="txt_inp" placeholder="–ö–ª–∞—Å" id="klas" type="text"></div>
            </div>

            <div class="student">
                <h2>–í–ø–∏—à—ñ—Ç—å –≤–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–º'—è</h2>
                <div><input class="txt_inp" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ, —ñ–º'—è" id="name" type="text"></div>
            </div>

            <div class="section">
                <h2>üéØ –ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏</h2>
                <p>–ù–∞–≤—á–∏—Ç–∏—Å—è –≤–∏–º—ñ—Ä—é–≤–∞—Ç–∏ –¥–æ–≤–∂–∏–Ω—É —Å–≤—ñ—Ç–ª–æ–≤–æ—ó —Ö–≤–∏–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ—ó “ë—Ä–∞—Ç–∫–∏.</p>
            </div>

            <div class="section">
                <h2>üìö –¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ</h2>
                
                <p><strong>–î–∏—Ñ—Ä–∞–∫—Ü—ñ—è —Å–≤—ñ—Ç–ª–∞</strong> ‚Äî —è–≤–∏—â–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Å–≤—ñ—Ç–ª–∞ –≤—ñ–¥ –ø—Ä—è–º–æ–ª—ñ–Ω—ñ–π–Ω–æ–≥–æ –ø–æ—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∏ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—ñ —á–µ—Ä–µ–∑ –º–∞–ª—ñ –æ—Ç–≤–æ—Ä–∏ –∞–±–æ –ø–æ–±–ª–∏–∑—É –ø–µ—Ä–µ—à–∫–æ–¥.</p>
                
                <p style="margin-top: 15px;"><strong>–î–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–∞ “ë—Ä–∞—Ç–∫–∞</strong> ‚Äî –æ–ø—Ç–∏—á–Ω–∏–π –ø—Ä–∏–ª–∞–¥, —â–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –≤–µ–ª–∏–∫–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ä—ñ–≤–Ω–æ–≤—ñ–¥–¥–∞–ª–µ–Ω–∏—Ö –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö —â—ñ–ª–∏–Ω.</p>

                <div class="formula">
                    d sin œÜ = k Œª
                    <br><small>–¥–µ d ‚Äî –ø–µ—Ä—ñ–æ–¥ “ë—Ä–∞—Ç–∫–∏, œÜ ‚Äî –∫—É—Ç –¥–∏—Ñ—Ä–∞–∫—Ü—ñ—ó, k ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–ø–µ–∫—Ç—Ä–∞, Œª ‚Äî –¥–æ–≤–∂–∏–Ω–∞ —Ö–≤–∏–ª—ñ</small>
                </div>

                <p>–î–ª—è –º–∞–ª–∏—Ö –∫—É—Ç—ñ–≤: sin œÜ ‚âà tan œÜ = a/l</p>

                <div class="formula">
                    Œª = (d √ó a) / l
                    <br><small>–¥–µ a ‚Äî –≤—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É –¥–æ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ—ó –ª—ñ–Ω—ñ—ó, l ‚Äî –≤—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ “ë—Ä–∞—Ç–∫–∏ –¥–æ –µ–∫—Ä–∞–Ω—É</small>
                </div>

                <div class="info-box">
                    <strong>–î—ñ–∞–ø–∞–∑–æ–Ω–∏ –¥–æ–≤–∂–∏–Ω —Ö–≤–∏–ª—å –≤–∏–¥–∏–º–æ–≥–æ —Å–≤—ñ—Ç–ª–∞:</strong><br>
                    ‚Ä¢ –§—ñ–æ–ª–µ—Ç–æ–≤–∏–π: 380-450 –Ω–º<br>
                    ‚Ä¢ –ß–µ—Ä–≤–æ–Ω–∏–π: 620-760 –Ω–º
                </div>
            </div>

            <div class="section">
                <h2>üî¨ –í—ñ—Ä—Ç—É–∞–ª—å–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</h2>
                
                <div class="simulation-container">
                    <canvas id="diffractionCanvas" width="800" height="400"></canvas>
                    
                    <div class="controls">
                        <div class="control-group">
                            <label>–ü–µ—Ä—ñ–æ–¥ “ë—Ä–∞—Ç–∫–∏ d (–º–∫–º)</label>
                            <div class="slider-container">
                                <input type="range" id="gratingPeriod" min="1" max="10" value="2" step="0.1">
                                <span class="value-display" id="gratingValue">2.0</span>
                            </div>
                        </div>

                        <div class="control-group">
                            <label>–í—ñ–¥—Å—Ç–∞–Ω—å –¥–æ –µ–∫—Ä–∞–Ω—É l (—Å–º)</label>
                            <div class="slider-container">
                                <input type="range" id="screenDistance" min="10" max="50" value="30" step="1">
                                <span class="value-display" id="distanceValue">30</span>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 15px;">
                        <button id="measureBtn">üìè –í–∏–º—ñ—Ä—è—Ç–∏ —Å–ø–µ–∫—Ç—Ä</button>
                    </div>

                    <div id="measurements" class="measurement-display" style="display: none;"></div>
                </div>

                <div class="info-box">
                    <strong>üí° –Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è:</strong><br>
                    1. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–µ—Ä—ñ–æ–¥ –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ—ó “ë—Ä–∞—Ç–∫–∏ —Ç–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –¥–æ –µ–∫—Ä–∞–Ω—É<br>
                    2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–í–∏–º—ñ—Ä—è—Ç–∏ —Å–ø–µ–∫—Ç—Ä" –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö<br>
                    3. –ó–∞–ø–∏—à—ñ—Ç—å –≤–∏–º—ñ—Ä—è–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —É —Ç–∞–±–ª–∏—Ü—é –Ω–∏–∂—á–µ
                </div>
            </div>

            <div class="section">
                <h2>üî¨ –•—ñ–¥ —Ä–æ–±–æ—Ç–∏</h2>
                
                <h3 style="color: #764ba2; margin-top: 15px;">–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É</h3>
                <ol class="instruction-list">
                    <li>–í–∏–∑–Ω–∞—á—Ç–µ –ø–µ—Ä—ñ–æ–¥ –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ—ó “ë—Ä–∞—Ç–∫–∏ –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é: d = 10‚Åª¬≥–º / N, –¥–µ N ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å —à—Ç—Ä–∏—Ö—ñ–≤ –Ω–∞ 1 –º–º</li>
                    <li>–í–∏–º—ñ—Ä—è–π—Ç–µ –≤—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ “ë—Ä–∞—Ç–∫–∏ –¥–æ –µ–∫—Ä–∞–Ω—É</li>
                </ol>

                <h3 style="color: #764ba2; margin-top: 20px;">–í–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏–º—ñ—Ä—é–≤–∞–Ω—å</h3>
                <ol class="instruction-list">
                    <li>–°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω—ñ —Å–ø–µ–∫—Ç—Ä–∏ –Ω–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–º—É –µ–∫—Ä–∞–Ω—ñ</li>
                    <li>–í–∏–º—ñ—Ä—è–π—Ç–µ –≤—ñ–¥—Å—Ç–∞–Ω—å a‚ÇÅ –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É –¥–æ –º–µ–∂—ñ —Ñ—ñ–æ–ª–µ—Ç–æ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É (–ø—Ä–∞–≤–æ—Ä—É—á)</li>
                    <li>–í–∏–º—ñ—Ä—è–π—Ç–µ –≤—ñ–¥—Å—Ç–∞–Ω—å a‚ÇÇ –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É –¥–æ –º–µ–∂—ñ —Ñ—ñ–æ–ª–µ—Ç–æ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É (–ª—ñ–≤–æ—Ä—É—á)</li>
                    <li>–ü–æ–≤—Ç–æ—Ä—ñ—Ç—å –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –¥–ª—è —á–µ—Ä–≤–æ–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É</li>
                    <li>–û–±—á–∏—Å–ª—ñ—Ç—å —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è: a_—Å–µ—Ä = (a‚ÇÅ + a‚ÇÇ) / 2</li>
                </ol>
            </div>

            <div class="section">
                <h2>üìä –¢–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</h2>
                
                <div style="margin-bottom: 15px;">
                    <label style="font-weight: 600; color: #667eea;">–ü–µ—Ä—ñ–æ–¥ “ë—Ä–∞—Ç–∫–∏ d (–º):</label>
                    <input type="number" id="period_d" step="0.000001" style="padding: 8px; margin-left: 10px; border: 1px solid #ddd; border-radius: 4px;">
                </div>

                <div style="margin-bottom: 15px;">
                    <label style="font-weight: 600; color: #667eea;">–í—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ “ë—Ä–∞—Ç–∫–∏ –¥–æ –µ–∫—Ä–∞–Ω—É l (–º):</label>
                    <input type="number" id="distance_l" step="0.01" style="padding: 8px; margin-left: 10px; border: 1px solid #ddd; border-radius: 4px;">
                </div>

                <table class="experiment-table">
                    <thead>
                        <tr>
                            <th>–ö–æ–ª—ñ—Ä —Å–ø–µ–∫—Ç—Ä–∞</th>
                            <th>a‚ÇÅ (–º)</th>
                            <th>a‚ÇÇ (–º)</th>
                            <th>a_—Å–µ—Ä (–º)</th>
                            <th>Œª –≤–∏–º—ñ—Ä—è–Ω–∞ (–Ω–º)</th>
                            <th>Œª —Ç–∞–±–ª–∏—á–Ω–∞ (–Ω–º)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>–§—ñ–æ–ª–µ—Ç–æ–≤–∏–π</td>
                            <td><input id="violet_a1" type="number" step="0.001"></td>
                            <td><input id="violet_a2" type="number" step="0.001"></td>
                            <td><input id="violet_avg" type="number" step="0.001"></td>
                            <td><input id="violet_lambda" type="number" step="0.1"></td>
                            <td>380-450</td>
                        </tr>
                        <tr>
                            <td>–ß–µ—Ä–≤–æ–Ω–∏–π</td>
                            <td><input id="red_a1" type="number" step="0.001"></td>
                            <td><input id="red_a2" type="number" step="0.001"></td>
                            <td><input id="red_avg" type="number" step="0.001"></td>
                            <td><input id="red_lambda" type="number" step="0.1"></td>
                            <td>620-760</td>
                        </tr>
                    </tbody>
                </table>

                <button onclick="calculateWavelengths()" style="margin: 15px 0;">üî¢ –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –¥–æ–≤–∂–∏–Ω–∏ —Ö–≤–∏–ª—å</button>
            </div>

            <div class="section">
                <h2>‚≠ê –û—Ü—ñ–Ω–∫–∞ –ø–æ—Ö–∏–±–∫–∏</h2>
                
                <div class="formula">
                    Œµ = |1 - Œª_–≤–∏–º / Œª_—Ç–∞–±–ª| √ó 100%
                </div>

                <div style="margin: 15px 0;">
                    <label style="font-weight: 600;">Œª —Ç–∞–±–ª–∏—á–Ω–∞ (–Ω–º):</label>
                    <input type="number" id="lambda_table" style="padding: 8px; margin: 0 10px; border: 1px solid #ddd; border-radius: 4px;">
                    
                    <label style="font-weight: 600;">Œª –≤–∏–º—ñ—Ä—è–Ω–∞ (–Ω–º):</label>
                    <input type="number" id="lambda_measured" style="padding: 8px; margin: 0 10px; border: 1px solid #ddd; border-radius: 4px;">
                    
                    <button onclick="calculateError()">–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –ø–æ—Ö–∏–±–∫—É</button>
                </div>

                <div id="errorResult" style="margin-top: 15px; font-size: 1.1em; font-weight: bold;"></div>
            </div>

            <div class="section">
                <h2>üìù –í–∏—Å–Ω–æ–≤–æ–∫</h2>
                
                <p style="margin-bottom: 10px;"><strong>–£ –≤–∏—Å–Ω–æ–≤–∫—É –∑–∞–∑–Ω–∞—á—Ç–µ:</strong></p>
                <ol class="instruction-list">
                    <li>–Ø–∫—É —Ñ—ñ–∑–∏—á–Ω—É –≤–µ–ª–∏—á–∏–Ω—É –≤–∏ –≤–∏–∑–Ω–∞—á–∞–ª–∏</li>
                    <li>–Ø–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Ä–∏–º–∞–ª–∏</li>
                    <li>–£ —á–æ–º—É –ø—Ä–∏—á–∏–Ω–∏ –º–æ–∂–ª–∏–≤–æ—ó –ø–æ—Ö–∏–±–∫–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É</li>
                </ol>

                <textarea id="conclusion" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –≤–∞—à –≤–∏—Å–Ω–æ–≤–æ–∫ —Ç—É—Ç..."></textarea>
            </div>

            <div class="submit_block">
                <button id="submit_button">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('diffractionCanvas');
        const ctx = canvas.getContext('2d');
        
        let gratingPeriod = 2.0;
        let screenDistance = 30;

        function drawDiffraction() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            const colors = [
                { color: '#8B00FF', lambda: 420, name: 'violet' },
                { color: '#4B0082', lambda: 450, name: 'indigo' },
                { color: '#0000FF', lambda: 480, name: 'blue' },
                { color: '#00FF00', lambda: 530, name: 'green' },
                { color: '#FFFF00', lambda: 580, name: 'yellow' },
                { color: '#FF7F00', lambda: 620, name: 'orange' },
                { color: '#FF0000', lambda: 680, name: 'red' }
            ];

            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, canvas.height);
            ctx.stroke();

            ctx.fillStyle = '#ffffff';
            ctx.font = '12px monospace';
            ctx.fillText('–¶–µ–Ω—Ç—Ä (0)', centerX + 5, centerY - 10);

            for (let order = -2; order <= 2; order++) {
                if (order === 0) continue;

                colors.forEach(spec => {
                    const d = gratingPeriod * 1e-6;
                    const lambda = spec.lambda * 1e-9;
                    const l = screenDistance * 0.01;
                    
                    const sinPhi = (order * lambda) / d;
                    if (Math.abs(sinPhi) > 1) return;
                    
                    const a = l * Math.tan(Math.asin(sinPhi));
                    const pixelOffset = (a / l) * 200;
                    
                    const x = centerX + pixelOffset * Math.sign(order);
                    
                    const gradient = ctx.createLinearGradient(x - 10, 0, x + 10, 0);
                    gradient.addColorStop(0, 'rgba(0,0,0,0)');
                    gradient.addColorStop(0.5, spec.color);
                    gradient.addColorStop(1, 'rgba(0,0,0,0)');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x - 10, 0, 20, canvas.height);
                    
                    if (Math.abs(order) === 1) {
                        ctx.fillStyle = '#ffffff';
                        ctx.font = '10px monospace';
                        ctx.fillText(`${spec.name}`, x - 15, canvas.height - 10);
                    }
                });
            }

            ctx.fillStyle = '#ffffff';
            ctx.font = '14px monospace';
            ctx.fillText('‚Üê –°–ø–µ–∫—Ç—Ä 1-–≥–æ –ø–æ—Ä—è–¥–∫—É', 50, 30);
            ctx.fillText('–°–ø–µ–∫—Ç—Ä 1-–≥–æ –ø–æ—Ä—è–¥–∫—É ‚Üí', canvas.width - 200, 30);
        }

        document.getElementById('gratingPeriod').addEventListener('input', function() {
            gratingPeriod = parseFloat(this.value);
            document.getElementById('gratingValue').textContent = gratingPeriod.toFixed(1);
            drawDiffraction();
        });

        document.getElementById('screenDistance').addEventListener('input', function() {
            screenDistance = parseInt(this.value);
            document.getElementById('distanceValue').textContent = screenDistance;
            drawDiffraction();
        });

        document.getElementById('measureBtn').addEventListener('click', function() {
            const d = gratingPeriod * 1e-6;
            const l = screenDistance * 0.01;
            
            const violetLambda = 420e-9;
            const redLambda = 680e-9;
            
            const violetA = l * Math.tan(Math.asin(violetLambda / d));
            const redA = l * Math.tan(Math.asin(redLambda / d));
            
            const measureDiv = document.getElementById('measurements');
            measureDiv.style.display = 'block';
            measureDiv.innerHTML = `
                <strong>üìè –í–∏–º—ñ—Ä—è–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</strong><br><br>
                <strong>–§—ñ–æ–ª–µ—Ç–æ–≤–∏–π –∫–æ–ª—ñ—Ä:</strong><br>
                a (–≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É) = ${(violetA * 100).toFixed(2)} —Å–º = ${violetA.toFixed(4)} –º<br>
                Œª —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ = ${(violetLambda * 1e9).toFixed(0)} –Ω–º<br><br>
                <strong>–ß–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä:</strong><br>
                a (–≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É) = ${(redA * 100).toFixed(2)} —Å–º = ${redA.toFixed(4)} –º<br>
                Œª —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ = ${(redLambda * 1e9).toFixed(0)} –Ω–º<br><br>
                <em>–ó–∞–ø–∏—à—ñ—Ç—å —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —É —Ç–∞–±–ª–∏—Ü—é (–ø–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ a‚ÇÅ —ñ a‚ÇÇ ‚Äî –≤—ñ–¥—Å—Ç–∞–Ω—ñ –∑ —Ä—ñ–∑–Ω–∏—Ö –±–æ–∫—ñ–≤)</em>
            `;
        });

        function calculateWavelengths() {
            const d = parseFloat(document.getElementById('period_d').value);
            const l = parseFloat(document.getElementById('distance_l').value);
            
            if (!d || !l) {
                alert('–°–ø–æ—á–∞—Ç–∫—É –≤–≤–µ–¥—ñ—Ç—å –ø–µ—Ä—ñ–æ–¥ “ë—Ä–∞—Ç–∫–∏ —Ç–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –¥–æ –µ–∫—Ä–∞–Ω—É!');
                return;
            }

            ['violet', 'red'].forEach(color => {
                const a1 = parseFloat(document.getElementById(`${color}_a1`).value) || 0;
                const a2 = parseFloat(document.getElementById(`${color}_a2`).value) || 0;
                
                if (a1 && a2) {
                    const avg = (a1 + a2) / 2;
                    document.getElementById(`${color}_avg`).value = avg.toFixed(4);
                    
                    const lambda = (d * avg) / l;
                    const lambdaNm = lambda * 1e9;
                    document.getElementById(`${color}_lambda`).value = lambdaNm.toFixed(1);
                }
            });
            
            alert('‚úÖ –î–æ–≤–∂–∏–Ω–∏ —Ö–≤–∏–ª—å —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–æ!');
        }

        function calculateError() {
            const lambdaTable = parseFloat(document.getElementById('lambda_table').value);
            const lambdaMeasured = parseFloat(document.getElementById('lambda_measured').value);
            
            if (!lambdaTable || !lambdaMeasured) {
                document.getElementById('errorResult').innerHTML = '<span style="color: #f5576c;">‚ùå –í–≤–µ–¥—ñ—Ç—å –æ–±–∏–¥–≤–∞ –∑–Ω–∞—á–µ–Ω–Ω—è!</span>';
                return;
            }
            
            const error = Math.abs(1 - lambdaMeasured / lambdaTable) * 100;
            document.getElementById('errorResult').innerHTML = `<span style="color: #56ab2f;">‚úì –í—ñ–¥–Ω–æ—Å–Ω–∞ –ø–æ—Ö–∏–±–∫–∞: Œµ = ${error.toFixed(2)}%</span>`;
        }

        document.getElementById('submit_button').addEventListener('click', async function() {
            const klas = document.getElementById('klas').value.trim();
            const name = document.getElementById('name').value.trim();

            if (!klas || !name) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –∫–ª–∞—Å —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ/—ñ–º\'—è!');
                return;
            }

            const data = {
                sheetName: document.getElementById('sheetName').value,
                studentInfo: {
                    '–ö–ª–∞—Å': klas,
                    '–ü—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–º\'—è': name,
                    '–î–∞—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è': new Date().toLocaleString('uk-UA')
                },
                parameters: {
                    '–ü–µ—Ä—ñ–æ–¥ “ë—Ä–∞—Ç–∫–∏ d (–º)': document.getElementById('period_d').value,
                    '–í—ñ–¥—Å—Ç–∞–Ω—å –¥–æ –µ–∫—Ä–∞–Ω—É l (–º)': document.getElementById('distance_l').value
                },
                measurements: {
                    violet: {
                        'a‚ÇÅ (–º)': document.getElementById('violet_a1').value,
                        'a‚ÇÇ (–º)': document.getElementById('violet_a2').value,
                        'a_—Å–µ—Ä (–º)': document.getElementById('violet_avg').value,
                        'Œª –≤–∏–º—ñ—Ä—è–Ω–∞ (–Ω–º)': document.getElementById('violet_lambda').value
                    },
                    red: {
                        'a‚ÇÅ (–º)': document.getElementById('red_a1').value,
                        'a‚ÇÇ (–º)': document.getElementById('red_a2').value,
                        'a_—Å–µ—Ä (–º)': document.getElementById('red_avg').value,
                        'Œª –≤–∏–º—ñ—Ä—è–Ω–∞ (–Ω–º)': document.getElementById('red_lambda').value
                    }
                },
                error: document.getElementById('errorResult').textContent,
                conclusion: document.getElementById('conclusion').value
            };

            try {
                await fetch('https://script.google.com/macros/s/AKfycbxMa02J8zAwQ6fsCE2yQVWTn65jL-cUYP0RxOOUcA0b7Ym8x-0ZSHbBDj9OC_MU6Nxl/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                alert('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É—Å–ø—ñ—à–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!\n\n–î—è–∫—É—î–º–æ –∑–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏.');
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏:', error);
                alert('‚ùå –í–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ –¥–∞–Ω–∏—Ö.\n–°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –∞–±–æ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –≤—á–∏—Ç–µ–ª—è.');
            }
        });

        drawDiffraction();
    </script>
</body>
</html>
